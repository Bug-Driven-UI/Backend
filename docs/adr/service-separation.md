# ADR: Разделение BDUIX Backend на два сервиса — Admin и Engine

Статус: **Предложено**

---

## Контекст

На текущий момент BDUIX Backend реализован как монолитный сервис, который одновременно:

- обрабатывает клиентские запросы (рендеринг экранов, навигация, обновления контента);
- предоставляет административный функционал (создание и редактирование экранов, управление конфигурациями, настройка
  навигации, эксперименты и др.).

Проблемы текущего подхода:

- Смешение логики "движка" (runtime для клиентов) и "админки" (CRUD-интерфейсы для редакторов/менеджеров);
- Усложнение разработки и тестирования (любые изменения в админке могут повлиять на стабильность клиентского API);
- Сложность масштабирования: нагрузка от пользователей и нагрузка от администраторов конкурируют за одни ресурсы;
- Ограниченная безопасность: административный интерфейс доступен через тот же сервис и требует более жёсткой защиты.

---

## Решение

Разделить BDUIX Backend на два самостоятельных сервиса:

1. **BDUIX Engine**
    - Основной runtime для клиентов (мобильных приложений, веб-клиентов);
    - Обработка запросов на отрисовку экранов, навигацию, действия пользователя;
    - Высокопроизводительный, лёгкий сервис, оптимизированный под нагрузку;
    - Минимальные зависимости.

2. **BDUIX Admin**
    - Панель управления и API для администраторов, редакторов и аналитиков;
    - CRUD для экранов, навигации, конфигураций и экспериментов;
    - Авторизация и разграничение прав доступа;
    - Может использовать общую БД с Engine или отдельную (через синхронизацию/репликацию).

---

## Последствия

**Преимущества:**

+ Масштабируемость: Engine можно масштабировать под пользовательский трафик, Admin — отдельно и значительно меньше;
+ Безопасность: админка может быть вынесена в закрытый контур и защищена отдельно;
+ Разделение зон ответственности: разные команды могут развивать Engine и Admin независимо;
+ Упрощение кода: каждая часть решает строго свою задачу.

**Недостатки:**

- Увеличение инфраструктурной сложности (два сервиса, деплой, CI/CD, мониторинг);
- Потребность в чёткой схеме синхронизации данных (например, при редактировании экранов в Admin изменения должны быть
  сразу доступны в Engine);
- Потенциальная задержка при распространении изменений (если используется асинхронная репликация).

---

## Альтернативы

- **Оставить монолит**: просто, но проблемы с масштабируемостью и безопасностью сохраняются;
- **Выделить только админку как отдельный UI**, но оставить API внутри Engine: частичное решение, но нагрузка и
  безопасность остаются смешанными;
- **Использовать сторонние headless CMS**: можно ускорить разработку, но потеряется гибкость и tight integration с BDUIX
  Engine.
